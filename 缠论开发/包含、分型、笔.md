缠论（全称“缠中说禅理论”），是由网络ID“缠中说畅”提出的一套技术分析理论，其核心内容包括**分型、笔、线段、中枢、走势类型、级别、背驰**等概念。本文将重点详述缠论中的**包含关系、分型、笔**这三个基础构件，这是构建后续高级结构（如线段、中枢等）的基石。

---

## 一、包含关系（包含处理）

### 1.1 什么是包含关系？
在K线序列中，若相邻的两根K线（通常是连续的三根或更多）出现**一根K线的最高价 ≥ 另一根的最高价，且最低价 ≤ 另一根的最低价**，则称这两根K线存在**包含关系**。

例如：
- K1：最高10，最低8；
- K2：最高9，最低8.5；
→ K1完全“包含”K2，即K2在K1的范围内。

### 1.2 为什么要处理包含关系？
包含关系会干扰分型的识别，导致信号模糊。因此，在识别分型前，**必须先对原始K线序列进行包含处理（合并）**，形成“无包含”的K线序列。

### 1.3 包含处理规则（方向判断）
处理包含关系时，需先判断当前趋势方向（向上 or 向下），再决定合并方式：

- **向上趋势（从左到右看）**：取**高点更高、低点更高**的方向。合并时：
  - 新K线高点 = max(两根K线高点)
  - 新K线低点 = max(两根K线低点) → **向上取高**
  
- **向下趋势**：取**高点更低、低点更低**的方向。合并时：
  - 新K线高点 = min(两根K线高点)
  - 新K线低点 = min(两根K线低点) → **向下取低**

> ⚠️ 趋势方向如何判断？通常从第一个**明显分型**开始确定方向。若尚无分型，可向前追溯或按默认方向处理（实践中常从左至右，用前两根非包含K线判断方向）。

### 1.4 多根包含的处理
包含处理需**从左到右依次进行**，合并后可能与下一根仍存在包含，需继续合并，直到无包含为止。

---

## 二、分型（Fractal）

### 2.1 分型的定义
分型是三根**无包含关系**的K线组成的结构，分为：

- **顶分型（Top Fractal）**：中间K线高点最高，左右两根K线高点都低于它。
  - 形态：高-更高-低（中间最高）
- **底分型（Bottom Fractal）**：中间K线低点最低，左右两根K线低点都高于它。
  - 形态：低-更低-高（中间最低）

> 注意：只需比较**高点和低点**，不要求实体或收盘价。

### 2.2 分型的意义
- 顶分型 → 潜在**上涨结束、下跌开始**的信号；
- 底分型 → 潜在**下跌结束、上涨开始**的信号；
- 但**单一分型不构成买卖点**，需结合后续结构（如笔、线段）确认。

### 2.3 分型有效性要求
- 顶分型与底分型**不能共用K线**；
- 两个相邻分型之间**至少间隔一根K线**（即不能连续出现顶-底-顶，中间无间隔）；
- 分型需在**无包含处理后的K线序列**中识别。

---

## 三、笔（Bi）

### 3.1 笔的定义
笔是连接**相邻的顶分型与底分型**的一段走势，需满足以下条件：

1. **必须由一个顶分型和一个底分型组成**（顶→底 或 底→顶）；
2. **两个分型之间至少有一根独立K线**（即不共用K线）；
3. **分型之间的K线数量 ≥ 3根**（即从顶分型中间K到底分型中间K，中间至少隔1根，总共至少3根K线）；
4. **价格波动需有力度**：顶到底（或底到顶）的**高低点之间必须有重叠以外的价格区间**（即不能完全包含）。

> 缠师原话：“**顶分型与底分型之间至少有一K线不属于任何分型**。”

### 3.2 笔的方向
- **向上笔**：从底分型 → 顶分型；
- **向下笔**：从顶分型 → 底分型。

### 3.3 笔的确认
- 笔的完成需**右侧确认**：即底分型（或顶分型）形成后，需有后续K线确认其有效性（例如，底分型后出现更高高点）；
- 实战中，常以**下一分型出现且满足条件**作为前一笔的完成信号。

### 3.4 常见错误
- 将包含未处理的K线直接画笔；
- 忽略分型之间的K线数量要求；
- 允许相邻分型共用K线（这是不允许的）。

---

## 四、三者关系总结

| 构件      | 作用                         | 前提条件                     |
|-----------|------------------------------|------------------------------|
| 包含处理  | 清理K线噪音，形成标准序列     | 原始K线可能存在包含           |
| 分型      | 识别局部高低点                | 在无包含K线序列中识别         |
> 顶/底分型 |                              |                              |
| 笔        | 连接分型，构成最小趋势单元    | 两个有效分型 + 中间隔K线 ≥1  |

> 📌 **逻辑顺序**：原始K线 → 包含处理 → 识别分型 → 连接有效分型成笔。

---

## 五、图示说明（文字模拟）

假设原始K线（高-低）：
```
K1: 10-8  
K2: 9-8.5  ← 被K1包含
K3: 11-9   ← 向上，合并K1-K2：取高=max(10,9)=10，低=max(8,8.5)=8.5 → 新K1':10-8.5
再与K3比较：K3(11-9) 与 K1'(10-8.5) 无包含 → 序列为 [10-8.5, 11-9, ...]
```

后续出现：
```
K4: 10.5-8.8  
K5: 9-7     ← 形成底分型（K3高11, K4高10.5, K5高9；低点：9,8.8,7 → 中间K4非最低，但K5最低，需三根无包含K线）

若K3、K4、K5无包含，且K4高< K3高，K4低> K5低 → 则K5为底分型中间K。
```

若此前有顶分型（如K0），且与K5底分型满足间隔和K线数，则可连成**向下笔**。

---

## 六、注意事项

1. **包含处理是缠论分析的第一步，不可跳过**；
2. **分型不等于转折，笔才是最小趋势单位**；
3. **笔的划分存在主观性**，但应严格遵循规则，避免“画线随心”；
4. 在自动化程序中，包含处理和笔的识别可标准化，但需处理边界情况；
5. 缠论强调**完全分类、不测而测**，所有走势必落在定义之内。

---

如需进一步了解**线段、中枢、背驰**等内容，可在此基础上继续深入。缠论是一套严密的几何化走势分解体系，基础构件的准确性直接影响后续分析的可靠性。